# TTS Audio Suite - Universal TTS for ComfyUI
# Comprehensive multi-engine TTS with Python 3.13 compatibility

# --- INSTALLATION METHOD ---
# This custom node uses install.py for intelligent dependency management.
# ComfyUI Manager automatically runs install.py which handles:
# - Python 3.13 compatibility issues (MediaPipe → OpenSeeFace fallback)
# - NumPy version conflicts (constraints to avoid Numba issues)
# - Package dependency conflicts (selective --no-deps installation)
# - All bundled engines: ChatterBox, F5-TTS, Higgs Audio
# - Optional features: RVC voice conversion, mouth movement analysis

# --- CORE SAFE PACKAGES ---
# These packages rarely cause conflicts and install normally

# Foundation ML packages
torch
torchaudio
numpy

# Audio processing (safe)
soundfile
sounddevice

# Text processing (safe)
jieba
pypinyin
unidecode
phonemizer              # IPA phonemization for multilingual TTS (requires espeak system dependency)
omegaconf
transformers  # Required for VibeVoice compatibility (VibeVoice requires 4.51.3+), also supports Higgs Audio

# ML utilities (safe)
accelerate
datasets
requests
dacite
bitsandbytes    # 4-bit quantization support for VibeVoice memory efficiency

# Bundled engine dependencies (safe)
conformer     # ChatterBox engine
x-transformers  
torchdiffeq          # F5-TTS differential equations
wandb                # F5-TTS logging
ema-pytorch          # F5-TTS exponential moving average
vocos                # F5-TTS vocoder

# IndexTTS-2 engine dependencies (safe)
cn2an        # Chinese number to Arabic number conversion
g2p-en         # English grapheme-to-phoneme conversion
keras         # Deep learning framework
modelscope    # Chinese model hub for IndexTTS-2
munch         # Dictionary access with dot notation
json5         # JSON5 parsing for IndexTTS-2 config files
ninja       # Build tool for CUDA kernel compilation (BigVGAN optimization)
sentencepiece  # Text tokenization
textstat      # Text statistics and readability

# RVC voice conversion (safe)
monotonic-alignment-search
faiss-cpu
praat-parselmouth # Praat-based f0 extraction for RVC (pm method)
pyworld          # World vocoder for RVC harvest/dio methods
torchfcpe        # Fast Context-based Pitch Estimation for RVC (fcpe method)

# Optional performance enhancements
# sageattention  # Optional: GPU-optimized mixed-precision attention for VibeVoice (requires CUDA SM80+)

# Computer vision (safe)
pillow

# --- PROBLEMATIC PACKAGES ---
# These are installed by install.py with special handling:
# - librosa (--no-deps): Forces numpy downgrade
# - descript-audio-codec (--no-deps): Conflicts with protobuf
# - cached-path (--no-deps): Forces package downgrades
# - torchcrepe (--no-deps): Conflicts via librosa dependency
# - onnxruntime (--no-deps): Forces numpy 2.3.x, needed for OpenSeeFace
# - opencv-python (--no-deps): Forces numpy downgrade

# --- PYTHON 3.13 NOTES ---
# ✅ All TTS engines work (ChatterBox, F5-TTS, Higgs Audio)
# ✅ RVC voice conversion works
# ✅ OpenSeeFace mouth movement (experimental alternative)
# ❌ MediaPipe incompatible (binary compatibility issue)

# --- BUNDLED ENGINES ---
# All engines are bundled to avoid external dependency conflicts:
# - ChatterBox: engines/chatterbox/ (modified for ComfyUI)
# - F5-TTS: engines/f5_tts/ (numpy 2.x compatible fork)
# - Higgs Audio: engines/higgs_audio/ (transformers 4.46+ compatible)
# - IndexTTS-2: engines/index_tts/ (emotion disentanglement TTS)

